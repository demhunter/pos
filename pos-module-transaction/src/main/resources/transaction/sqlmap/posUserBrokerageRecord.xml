<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pos.transaction.dao.PosUserBrokerageRecordDao">
    <insert id="save" parameterType="com.pos.transaction.dto.PosUserGetBrokerageRecordDto">
        INSERT INTO user_pos_get_brokerage_record
        (
            user_id,
            amount,
            pay_mode,
            voucher,
            pay_date,
            remark
        ) VALUES (
            #{record.userId},
            #{record.amount},
            #{record.payMode},
            #{record.voucher},
            NOW(),
            #{record.remark}
        )
    </insert>

    <select id="queryRecords" resultType="com.pos.transaction.dto.PosUserGetBrokerageRecordDto">
        SELECT
        <include refid="recordDtoColumns"/>
        FROM user_pos_get_brokerage_record upgbr
        WHERE upgbr.user_id = #{user.userId}
        LIMIT #{limitHelper.offset}, #{limitHelper.pageSize}
    </select>

    <select id="queryAllRecords" resultType="com.pos.transaction.dto.PosUserGetBrokerageRecordDto">
        SELECT
        <include refid="recordDtoColumns"/>
        FROM user_pos_get_brokerage_record upgbr
    </select>

    <sql id="recordDtoColumns">
        upgbr.`id` AS `id`,
        upgbr.user_id AS userId,
        upgbr.amount AS amount,
        upgbr.pay_mode AS payMode,
        upgbr.voucher AS voucher,
        upgbr.pay_date AS payDate,
        upgbr.remark AS remark
    </sql>
</mapper>
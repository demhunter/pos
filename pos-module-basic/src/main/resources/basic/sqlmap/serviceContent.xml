<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pos.basic.dao.ServiceContentDao">

    <insert id="save" parameterType="com.pos.basic.domain.ServiceContent" useGeneratedKeys="true" keyProperty="service.id">
        INSERT INTO service_content
        (
            `type`,
            `name`,
            description,
            create_time,
            update_time
        )
        VALUES
        (
            #{service.type},
            #{service.name},
            #{service.description},
            #{service.createTime},
            #{service.updateTime}
        )
    </insert>

    <update id="update">
        UPDATE service_content
        <set>
            <if test="service.type != null">
                `type` = #{service.type},
            </if>
            <if test="service.name != null">
                `name` = #{service.name},
            </if>
            <if test="service.description != null">
                description = #{service.description},
            </if>
            <if test="service.updateTime != null">
                update_time = #{service.updateTime}
            </if>
        </set>
        WHERE id = #{service.id}
    </update>

    <select id="getServiceContentCount" resultType="Integer">
        SELECT COUNT(*)
        FROM service_content
        <where>
            <if test="condition.type != null">
                `type` = #{condition.type}
            </if>
            <if test="condition.id != null">
                AND id = #{condition.id}
            </if>
            <if test="condition.name != null">
                AND `name` = #{condition.name}
            </if>
        </where>
    </select>

    <select id="queryServiceContents" resultType="com.pos.basic.domain.ServiceContent">
        SELECT
        id,
        `type`,
        `name`,
        description,
        create_time AS createTime,
        update_time AS updateTime
        FROM service_content
        <where>
            <if test="condition.type != null">
                `type` = #{condition.type}
            </if>
            <if test="condition.id != null">
                AND id = #{condition.id}
            </if>
            <if test="condition.name != null">
                AND `name` = #{condition.name}
            </if>
        </where>
        <if test="limitHelper != null">
            LIMIT #{limitHelper.offset}, #{limitHelper.pageSize}
        </if>
    </select>

    <select id="getServiceContent" resultType="com.pos.basic.dto.ServiceContentDto">
        SELECT
        <include refid="ServiceContentDtoColumn"/>
        FROM service_content sc
        <where>
            <if test="condition.id != null">
                sc.id = #{condition.id}
            </if>
            <if test="condition.name != null">
                sc.`name` = #{condition.name}
            </if>
            <if test="condition.type != null">
                sc.`type` = #{condition.type}
            </if>
        </where>
    </select>

    <sql id="ServiceContentDtoColumn">
        sc.id AS id,
        sc.`type` AS `type`,
        sc.`name` AS `name`,
        sc.description AS description,
        sc.create_time AS createTime,
        sc.update_time AS updateTime
    </sql>
</mapper>
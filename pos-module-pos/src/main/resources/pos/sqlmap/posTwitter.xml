<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pos.pos.dao.PosTwitterDao">

    <select id="queryChannelJuniorCount" resultType="int">
        SELECT COUNT(*)
        FROM user_pos_junior_info
        WHERE channel_user_id = #{channelUserId}
        AND relation_available = 1
    </select>

    <select id="queryChannelJuniors" resultType="com.pos.pos.dto.spread.SpreadCustomerDto">
        SELECT
            upji.id AS `id`,
            upji.channel_user_id AS channelUserId,
            upji.junior_user_id AS juniorUserId,
            upji.junior_phone AS juniorPhone,
            upji.junior_remark AS juniorRemark,
            upji.relation_available AS relationAvailable,
            upji.create_date AS createDate,
            upa.audit_status AS auditStatus,
            upa.id_card_name AS juniorName
        FROM user_pos_junior_info upji
        JOIN user_pos_auth upa ON upji.junior_user_id = upa.user_id
        WHERE upji.channel_user_id = #{channelUserId}
        AND upji.relation_available = 1
        ORDER BY upji.create_date DESC
        LIMIT #{limitHelper.offset}, #{limitHelper.pageSize}
    </select>

</mapper>